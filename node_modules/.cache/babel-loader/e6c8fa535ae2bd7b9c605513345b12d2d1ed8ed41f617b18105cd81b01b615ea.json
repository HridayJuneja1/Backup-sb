{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import{useTranslation}from'react-i18next';import axios from'axios';import'./BookDetail.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BookDetails=()=>{const{bookId}=useParams();const[book,setBook]=useState(null);const[isLoading,setIsLoading]=useState(true);const{t}=useTranslation();const[isLoggedIn]=useState(!!localStorage.getItem('user'));const[isBookInCart,setIsBookInCart]=useState(false);useEffect(()=>{const fetchBookDetails=async()=>{setIsLoading(true);try{const response=await axios.get(`/api/book/${bookId}`);setBook(response.data);setIsLoading(false);if(isLoggedIn){const user=JSON.parse(localStorage.getItem('user'));const cartResponse=await axios.get(`/api/cart/${encodeURIComponent(user.email)}`);const isBookAdded=cartResponse.data.items.some(item=>item.isbn===response.data.isbn);setIsBookInCart(isBookAdded);}}catch(error){console.error(\"Error fetching book details:\",error);setIsLoading(false);}};fetchBookDetails();},[bookId,isLoggedIn]);const addToCart=async()=>{if(!isLoggedIn){alert(t('login_to_add_to_cart'));return;}if(isBookInCart){alert(t('book_already_in_cart'));return;}const user=JSON.parse(localStorage.getItem('user'));const userEmail=user.email;try{const response=await axios.post(`/api/cart/add`,{title:book===null||book===void 0?void 0:book.title,isbn:book.isbn,image:book===null||book===void 0?void 0:book.image,publication:book===null||book===void 0?void 0:book.publication,standard:book===null||book===void 0?void 0:book.standard,description:book===null||book===void 0?void 0:book.description,publication_year:book===null||book===void 0?void 0:book.publication_year,dimensions:book===null||book===void 0?void 0:book.dimensions,userEmail});if(response.status===200){alert(t('book_added_to_cart'));setIsBookInCart(true);}else{alert(t('error_adding_to_cart'));}}catch(error){console.error(\"Error adding book to cart:\",error);alert(t('error_adding_to_cart'));}};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}if(!book){return/*#__PURE__*/_jsx(\"div\",{children:t('book_not_found')});}return/*#__PURE__*/_jsxs(\"div\",{className:\"book-detail\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header\",children:/*#__PURE__*/_jsx(\"h1\",{children:t('book_preview')})}),/*#__PURE__*/_jsxs(\"div\",{className:\"book-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"book-image\",children:/*#__PURE__*/_jsx(\"img\",{src:book===null||book===void 0?void 0:book.image,alt:t('title_not_available')})}),/*#__PURE__*/_jsxs(\"div\",{className:\"book-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"book-text\",children:[/*#__PURE__*/_jsx(\"h1\",{children:(book===null||book===void 0?void 0:book.title)||t('title_not_available')}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('publication'),\":\"]}),\" \",book.publication]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('isbn'),\":\"]}),\" \",book.isbn]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('publication_year'),\":\"]}),\" \",book.publication_year||t('na')]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('dimensions'),\":\"]}),\" \",book.dimensions||t('na')]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('description'),\":\"]}),\" \",book.description]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('standard'),\":\"]}),\" \",book.standard]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"add-to-cart-button\",onClick:addToCart,children:t('add_to_cart')})]})]})]});};export default BookDetails;","map":{"version":3,"names":["React","useEffect","useState","useParams","useTranslation","axios","jsx","_jsx","jsxs","_jsxs","BookDetails","bookId","book","setBook","isLoading","setIsLoading","t","isLoggedIn","localStorage","getItem","isBookInCart","setIsBookInCart","fetchBookDetails","response","get","data","user","JSON","parse","cartResponse","encodeURIComponent","email","isBookAdded","items","some","item","isbn","error","console","addToCart","alert","userEmail","post","title","image","publication","standard","description","publication_year","dimensions","status","children","className","src","alt","onClick"],"sources":["/Users/hrida/SYST35300/samskritabharati/src/components/BookDetails.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axios from 'axios';\r\nimport './BookDetail.css';\r\n\r\nconst BookDetails = () => {\r\n  const { bookId } = useParams();\r\n  const [book, setBook] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const { t } = useTranslation();\r\n  const [isLoggedIn] = useState(!!localStorage.getItem('user'));\r\n  const [isBookInCart, setIsBookInCart] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const fetchBookDetails = async () => {\r\n      setIsLoading(true);\r\n      try {\r\n        const response = await axios.get(`/api/book/${bookId}`);\r\n        setBook(response.data);\r\n        setIsLoading(false);\r\n\r\n        if (isLoggedIn) {\r\n          const user = JSON.parse(localStorage.getItem('user'));\r\n          const cartResponse = await axios.get(`/api/cart/${encodeURIComponent(user.email)}`);\r\n          const isBookAdded = cartResponse.data.items.some(item => item.isbn === response.data.isbn);\r\n          setIsBookInCart(isBookAdded);\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error fetching book details:\", error);\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchBookDetails();\r\n  }, [bookId, isLoggedIn]);\r\n\r\n  const addToCart = async () => {\r\n    if (!isLoggedIn) {\r\n      alert(t('login_to_add_to_cart'));\r\n      return;\r\n    }\r\n\r\n    if (isBookInCart) {\r\n      alert(t('book_already_in_cart'));\r\n      return;\r\n    }\r\n\r\n    const user = JSON.parse(localStorage.getItem('user'));\r\n    const userEmail = user.email;\r\n\r\n    try {\r\n      const response = await axios.post(`/api/cart/add`, {\r\n        title: book?.title,\r\n        isbn: book.isbn,\r\n        image: book?.image,\r\n        publication: book?.publication,\r\n        standard: book?.standard,\r\n        description: book?.description,\r\n        publication_year: book?.publication_year,\r\n        dimensions: book?.dimensions,\r\n        userEmail,\r\n      });\r\n      if (response.status === 200) {\r\n        alert(t('book_added_to_cart'));\r\n        setIsBookInCart(true);\r\n      } else {\r\n        alert(t('error_adding_to_cart'));\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error adding book to cart:\", error);\r\n      alert(t('error_adding_to_cart'));\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  if (!book) {\r\n    return <div>{t('book_not_found')}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"book-detail\">\r\n      <div className=\"header\">\r\n        <h1>{t('book_preview')}</h1>\r\n      </div>\r\n      <div className=\"book-content\">\r\n        <div className=\"book-image\">\r\n          <img src={book?.image} alt={t('title_not_available')} />\r\n        </div>\r\n        <div className=\"book-info\">\r\n          <div className=\"book-text\">\r\n            <h1>{book?.title || t('title_not_available')}</h1>\r\n            <p><strong>{t('publication')}:</strong> {book.publication}</p>\r\n            <p><strong>{t('isbn')}:</strong> {book.isbn}</p>\r\n            <p><strong>{t('publication_year')}:</strong> {book.publication_year || t('na')}</p>\r\n            <p><strong>{t('dimensions')}:</strong> {book.dimensions || t('na')}</p>\r\n            <p><strong>{t('description')}:</strong> {book.description}</p>\r\n            <p><strong>{t('standard')}:</strong> {book.standard}</p>\r\n          </div>\r\n          <button className=\"add-to-cart-button\" onClick={addToCart}>\r\n            {t('add_to_cart')}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BookDetails;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}